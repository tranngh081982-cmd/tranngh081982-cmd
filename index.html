<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B√†i 1: Th√¥ng tin v√† D·ªØ li·ªáu ‚Äì Ti·∫øt 1</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #f0f8ff; padding: 20px; }
    h1 { color: #2c3e50; }
    .question { margin-bottom: 20px; }
    .answers label { display: block; margin-bottom: 5px; }
    #result, .explanation { font-weight: bold; margin-top: 20px; font-size: 18px; }
    .correct { color: #27ae60; }
    .incorrect { color: #e74c3c; }
    button { padding: 10px 20px; font-size: 16px; background-color: #3498db; color: white; border: none; cursor: pointer; margin-right: 10px; }
    button:hover { background-color: #2980b9; }
    input[type="text"] { padding: 5px; font-size: 16px; margin-bottom: 20px; width: 300px; }
    #leaderboard { margin-top: 30px; background: #fff; padding: 10px; border: 1px solid #ccc; }
    #leaderboard h2 { margin-bottom: 10px; }
    #leaderboard ul { list-style: none; padding-left: 0; }
    #leaderboard li { margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>üìò B√†i 1: Th√¥ng tin v√† D·ªØ li·ªáu ‚Äì Ti·∫øt 1</h1>

  <label>Nh·∫≠p t√™n h·ªçc sinh: <input type="text" id="studentName" placeholder="V√≠ d·ª•: Minh"></label>
  <div id="quizContainer"></div>
  <button onclick="submitQuiz()">N·ªôp b√†i</button>
  <button onclick="exportToExcel()">üì• Xu·∫•t b·∫£ng x·∫øp h·∫°ng</button>

  <div id="result"></div>
  <div id="explanations"></div>

  <div id="leaderboard">
    <h2>üìä B·∫£ng x·∫øp h·∫°ng l·ªõp</h2>
    <ul id="rankingList"></ul>
  </div>

  <audio id="correctSound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

  <script>
    const questions = [
      {
        text: "D·ªØ li·ªáu l√† g√¨?",
        options: {
          a: "Th√¥ng tin ƒë√£ qua x·ª≠ l√≠.",
          b: "S·ª± ki·ªán, con s·ªë, k√≠ hi·ªáu th√¥.",
          c: "K·∫øt qu·∫£ h·ªçc t·∫≠p.",
          d: "Ki·∫øn th·ª©c con ng∆∞·ªùi ti·∫øp nh·∫≠n."
        },
        correct: "b",
        explain: "‚úÖ D·ªØ li·ªáu l√† c√°c con s·ªë, k√≠ hi·ªáu th√¥ ch∆∞a ƒë∆∞·ª£c x·ª≠ l√Ω."
      },
      {
        text: "Th√¥ng tin l√† g√¨?",
        options: {
          a: "K√≠ hi·ªáu ch∆∞a c√≥ √Ω nghƒ©a.",
          b: "Ki·∫øn th·ª©c r√∫t ra t·ª´ d·ªØ li·ªáu.",
          c: "D√£y s·ªë ng·∫´u nhi√™n.",
          d: "T·∫≠p h·ª£p d·ªØ li·ªáu."
        },
        correct: "b",
        explain: "‚úÖ Th√¥ng tin l√† ki·∫øn th·ª©c r√∫t ra t·ª´ d·ªØ li·ªáu ƒë√£ x·ª≠ l√Ω."
      },
      {
        text: "36¬∞C (nhi·ªát ƒë·ªô) l√†:",
        options: {
          a: "Th√¥ng tin.",
          b: "D·ªØ li·ªáu.",
          c: "V·ª´a d·ªØ li·ªáu v·ª´a th√¥ng tin.",
          d: "Kh√¥ng ph·∫£i d·ªØ li·ªáu."
        },
        correct: "b",
        explain: "‚úÖ 36¬∞C l√† d·ªØ li·ªáu v√¨ n√≥ ch∆∞a ƒë∆∞·ª£c ph√¢n t√≠ch hay so s√°nh."
      },
      {
        text: "‚ÄúNam cao h∆°n Minh‚Äù l√†:",
        options: {
          a: "D·ªØ li·ªáu.",
          b: "Th√¥ng tin.",
          c: "C·∫£ hai.",
          d: "Kh√¥ng ph·∫£i."
        },
        correct: "b",
        explain: "‚úÖ 'Nam cao h∆°n Minh' l√† th√¥ng tin v√¨ n√≥ mang √Ω nghƒ©a so s√°nh."
      },
      {
        text: "T·ª´ ƒëi·ªÉm 8, 9, 10 ‚Üí k·∫øt lu·∫≠n ‚ÄúNam h·ªçc gi·ªèi‚Äù l√†:",
        options: {
          a: "D·ªØ li·ªáu.",
          b: "Th√¥ng tin.",
          c: "D·ªØ li·ªáu th√¥.",
          d: "Kh√¥ng x√°c ƒë·ªãnh."
        },
        correct: "b",
        explain: "‚úÖ T·ª´ ƒëi·ªÉm s·ªë r√∫t ra k·∫øt lu·∫≠n l√† th√¥ng tin."
      }
    ];

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function renderQuiz() {
      const container = document.getElementById("quizContainer");
      container.innerHTML = "";
      const shuffledQuestions = shuffle([...questions]);

      shuffledQuestions.forEach((q, index) => {
        const qDiv = document.createElement("div");
        qDiv.className = "question";
        qDiv.innerHTML = `<h3>${index + 1}. ${q.text}</h3>`;
        const keys = shuffle(Object.keys(q.options));
        keys.forEach(k => {
          const label = document.createElement("label");
          label.innerHTML = `<input type="radio" name="q${index}" value="${k}"> ${k.toUpperCase()}. ${q.options[k]}`;
          qDiv.appendChild(label);
        });
        container.appendChild(qDiv);
      });

      window.shuffledQuestions = shuffledQuestions;
    }

    function submitQuiz() {
      const studentName = document.getElementById("studentName").value.trim();
      if (!studentName) {
        alert("Vui l√≤ng nh·∫≠p t√™n h·ªçc sinh.");
        return;
      }

      let score = 0;
      let explanationHTML = "";

      window.shuffledQuestions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected) {
          if (selected.value === q.correct) {
            score++;
            document.getElementById("correctSound").play();
            explanationHTML += `<div class="explanation correct">${q.explain}</div>`;
          } else {
            explanationHTML += `<div class="explanation incorrect">‚ùå Sai. ${q.explain}</div>`;
          }
        } else {
          explanationHTML += `<div class="explanation incorrect">‚ö†Ô∏è B·∫°n ch∆∞a ch·ªçn c√¢u ${index + 1}. ${q.explain}</div>`;
        }
      });

      document.getElementById("result").innerText = `üéì ${studentName}, b·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng ${score}/${window.shuffledQuestions.length} c√¢u h·ªèi!`;
      document.getElementById("explanations").innerHTML = explanationHTML;

      if (score === window.shuffledQuestions.length) {
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
      }

      localStorage.setItem(studentName, score);
      updateLeaderboard();
    }

    function updateLeaderboard() {
      const rankingList = document.getElementById("rankingList");
      rankingList.innerHTML = "";

      const scores = [];
      for (let i = 0; i < localStorage.length; i++) {
        const name = localStorage.key(i);
        const score = parseInt(localStorage.getItem(name));
        scores.push({ name, score });
      }

      scores.sort((a, b) => b.score - a.score);
      scores.forEach(entry => {
        const li = document.createElement("li");
        li.textContent = `${entry.name}: ${entry.score}/5 ƒëi·ªÉm`;
        rankingList.appendChild(li);
      });
    }

    function exportToExcel() {
      const data = [["T√™n h·ªçc sinh", "ƒêi·ªÉm"]];
      for (let i = 0; i < localStorage.length; i++) {
        const name = localStorage.key(i);
        const score = localStorage.getItem(name);
        data.push([name, score]);
      }

      const worksheet = XLSX.utils.aoa_to_sheet(data);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "B·∫£ng x·∫øp h·∫°ng");

      XLSX.writeFile(workbook, "bang_xep_hang.xlsx");
    }

    window.onload = () => {
      renderQuiz();
      updateLeaderboard();
    };
  </script>
</body>
</html>
